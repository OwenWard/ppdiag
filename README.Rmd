---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# ppdiag

<!-- badges: start -->
[![R build status](https://github.com/OwenWard/ppdiag/workflows/R-CMD-check/badge.svg)](https://github.com/OwenWard/ppdiag/actions)
[![Lifecycle: maturing](https://img.shields.io/badge/lifecycle-maturing-blue.svg)](https://www.tidyverse.org/lifecycle/#maturing)
[![Codecov test coverage](https://codecov.io/gh/OwenWard/ppdiag/branch/master/graph/badge.svg)](https://codecov.io/gh/OwenWard/ppdiag?branch=master)
<!-- badges: end -->


``ppdiag`` is an `R` package which provides a collection of tools which
can be used to assess the fit of temporal point processes to data.

These currently include:

- Simulating data from a specified point process
- Fitting a specified point process model to data
- Evaluating the fit of a point process model to data using 
several diagnostic tools

## Installation

<!-- You can install the released version of ppdiag from [CRAN](https://CRAN.R-project.org) with: -->

<!-- ``` r -->
<!-- install.packages("ppdiag") -->
<!-- ``` -->

The in development version of this
package is available from [GitHub](https://github.com/OwenWard/ppdiag) with:

``` r
# install.packages("devtools")
devtools::install_github("OwenWard/ppdiag")
```
## Example

To illustrate some of the basic functionality of this package,
we can simulate data from a specified Hawkes process and examine
our diagnostic results when we fit a homogeneous Poisson process
to this data.

```{r example}
library(ppdiag)

hp_obj <- hp(lambda0 = 0.2, alpha = 0.35, beta = 0.8)
sim_hp <- simulatehp(hp_obj, end = 200)
sim_hp

```
We can readily evaluate the fit of a homogeneous Poisson process to this
data.

```{r fit hpp}
est_hpp <- fithpp(sim_hp$events)
est_hpp

diagpp(est_hpp, events = sim_hp$events)
```


```{r fit hp}
hp_est <- fithp(events = sim_hp$events)
diagpp(hp_est, events = sim_hp$events)

```


## MMHP Example

This is particularly useful for more complex point processes, such as the 
Markov Modulated Hawkes Process. We can simulate events from this model
and examine the fit of simpler point processes to this data.

```{r mmhp example}
Q <- matrix(c(-0.2, 0.2, 0.1, -0.1), ncol = 2, byrow = TRUE)

mmhp_obj <- mmhp(Q, delta = c(1 / 3, 2 / 3), 
          lambda0 = 0.2,
          lambda1 = .75,
          alpha = 0.4,
          beta = 0.8)

mmhp_obj
mmhp_events <- simulatemmhp(mmhp_obj, n = 50)
```

We can easily fit a homogeneous Poisson process and visualise the goodness of 
fit.

```{r fit hpp to mmhp}
est_hpp <- fithpp(events = mmhp_events$events)
diagpp(est_hpp,mmhp_events$events)
```

Similarly for a Hawkes process.

```{r fit hp to mmhp}
est_hp <- fithp(events = mmhp_events$events)
diagpp(est_hp,mmhp_events$events)
```

We can then compare to the true point process model.

```{r fit mmhp}
diagpp(mmhp_obj,mmhp_events$events)
```