<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>`ppdiag`, diagnostic tools for Point Processes • ppdiag</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="`ppdiag`, diagnostic tools for Point Processes">
<meta property="og:description" content="ppdiag">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ppdiag</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/my-vignette.html">`ppdiag`, diagnostic tools for Point Processes</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>
<code>ppdiag</code>, diagnostic tools for Point Processes</h1>
                        <h4 class="author">Sally Sun, Owen G. Ward et al.</h4>
            
      
      
      <div class="hidden name"><code>my-vignette.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">ppdiag</span><span class="op">)</span></pre></div>
<p>This vignette provides an introduction to the functions available in <code>ppdiag</code> to evaluate the fit of univariate temporal point processes.</p>
<p>To achieve this, we currently include a range of functions which allow a user to:</p>
<ul>
<li>Simulate data from a range of common univariate point processes.</li>
<li>Fit a range of univariate point processes to data.</li>
<li>After fitting a point process to some data, evaluate the ability of that point process to capture the temporal structure present in this data.</li>
</ul>
<div id="classes" class="section level2">
<h2 class="hasAnchor">
<a href="#classes" class="anchor"></a>Classes</h2>
<ul>
<li>Homogeneous Poisson Process:</li>
</ul>
<p>hpp(lambda, start=0, end=1, n = NULL) creates an object of a list type in class ‘hpp’.</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="va">hpp_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hpp.html">hpp</a></span><span class="op">(</span>lambda <span class="op">=</span> <span class="fl">1</span>, end <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>
<span class="va">hpp_obj</span>
<span class="co">#&gt; $lambda</span>
<span class="co">#&gt; [1] 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $start</span>
<span class="co">#&gt; [1] 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $end</span>
<span class="co">#&gt; [1] 10</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $n</span>
<span class="co">#&gt; NULL</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $events</span>
<span class="co">#&gt; NULL</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"class")</span>
<span class="co">#&gt; [1] "hpp"</span></pre></div>
<ul>
<li>Hawkes Process:</li>
</ul>
<p>hp(lambda0, alpha, beta, events = NULL) creates an object of list type in class ‘hp’.</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="va">hp_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hp.html">hp</a></span><span class="op">(</span>lambda0 <span class="op">=</span> <span class="fl">0.1</span>,alpha <span class="op">=</span> <span class="fl">0.45</span>,beta <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>
<span class="va">hp_obj</span>
<span class="co">#&gt; $lambda0</span>
<span class="co">#&gt; [1] 0.1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $alpha</span>
<span class="co">#&gt; [1] 0.45</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $beta</span>
<span class="co">#&gt; [1] 0.5</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $events</span>
<span class="co">#&gt; NULL</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"class")</span>
<span class="co">#&gt; [1] "hp"</span></pre></div>
<ul>
<li>Markov-Modulated Hawkes Process:</li>
</ul>
<p>mmhp(lambda0, lambda1, alpha, beta, Q = NULL, delta = NULL, events = NULL) creates an object of type in class ‘mmhp’.</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="va">Q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.4</span>, <span class="fl">0.4</span>, <span class="fl">0.2</span>, <span class="op">-</span><span class="fl">0.2</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="va">mmhp_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mmhp.html">mmhp</a></span><span class="op">(</span><span class="va">Q</span>, delta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fl">3</span>, <span class="fl">2</span> <span class="op">/</span> <span class="fl">3</span><span class="op">)</span>, 
          lambda0 <span class="op">=</span> <span class="fl">0.2</span>,
          lambda1 <span class="op">=</span> <span class="fl">.75</span>,
          alpha <span class="op">=</span> <span class="fl">0.1</span>,
          beta <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></pre></div>
</div>
<div id="simulating-data" class="section level2">
<h2 class="hasAnchor">
<a href="#simulating-data" class="anchor"></a>Simulating data</h2>
<p>Functions for simulating data include simulatehpp, simulatehp, and simulatemmhp, which take in objects of type hpp, hp, and mmhp, respectively, with additional parameters for simulation, and produces vector of simulated event times.</p>
<ul>
<li>Homogeneous Poisson Process:</li>
</ul>
<p>simulatehpp(hpp) takes a hpp object and returns a vector of event times. In the hpp object, one can either specify n, which is expected number of events, or end, which is the expected end time of event times. If both are provided, then the function will automatically simulate n events regardless of the end time specified.</p>
<p>Simulating by end time:</p>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="va">events</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulatehpp.html">simulatehpp</a></span><span class="op">(</span><span class="va">hpp_obj</span><span class="op">)</span>
<span class="va">events</span>
<span class="co">#&gt; [1] 0.02 0.22 2.78 5.19 5.68 6.22 6.80 8.60 9.28</span></pre></div>
<p>Simulating by n:</p>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="va">hpp_obj</span><span class="op">$</span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">50</span>
<span class="fu"><a href="../reference/simulatehpp.html">simulatehpp</a></span><span class="op">(</span><span class="va">hpp_obj</span><span class="op">)</span>
<span class="co">#&gt; 50 events simulated, end time ignored. To simulate up to an endtime don't specify n.</span>
<span class="co">#&gt;  [1]  1.13  2.59  3.05  3.94  5.99  7.30  7.90  8.77  9.00  9.61 12.36 12.58</span>
<span class="co">#&gt; [13] 14.31 14.36 14.41 14.98 15.06 18.54 19.43 19.76 20.47 21.51 21.67 21.98</span>
<span class="co">#&gt; [25] 26.54 28.39 31.68 32.30 32.85 34.74 35.27 36.12 39.33 40.51 41.46 44.87</span>
<span class="co">#&gt; [37] 44.95 45.47 46.44 47.62 51.36 51.82 52.32 53.48 54.15 54.34 55.66 55.74</span>
<span class="co">#&gt; [49] 56.63 60.05</span></pre></div>
<ul>
<li>Hawkes Process:</li>
</ul>
<p>simulatehp(hp, start=0, end, history=0) returns a list containing t and lambda.max.</p>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="va">sims</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulatehp.html">simulatehp</a></span><span class="op">(</span><span class="va">hp_obj</span>,start <span class="op">=</span> <span class="fl">0</span>, end <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>
<span class="va">sims</span>
<span class="co">#&gt; $t</span>
<span class="co">#&gt;   [1]  0.735  8.701 11.649 12.271 12.291 12.553 12.816 13.052 13.265 13.277</span>
<span class="co">#&gt;  [11] 13.598 14.839 15.554 15.961 16.123 16.509 16.561 16.591 16.966 17.246</span>
<span class="co">#&gt;  [21] 18.038 19.570 19.629 20.185 20.194 20.323 20.329 20.759 20.836 21.096</span>
<span class="co">#&gt;  [31] 21.713 21.987 23.249 23.570 23.813 24.248 24.533 24.648 24.747 24.875</span>
<span class="co">#&gt;  [41] 24.985 25.006 25.458 25.861 26.275 26.408 26.508 26.686 26.881 27.345</span>
<span class="co">#&gt;  [51] 27.642 27.679 28.047 30.136 30.245 30.633 30.657 30.783 30.867 30.988</span>
<span class="co">#&gt;  [61] 31.764 32.039 32.148 32.310 32.328 32.768 33.253 33.349 33.710 33.729</span>
<span class="co">#&gt;  [71] 33.860 34.065 34.121 34.279 34.546 34.618 35.115 35.139 35.293 35.494</span>
<span class="co">#&gt;  [81] 35.520 35.643 35.772 36.038 36.051 36.249 36.539 36.649 36.824 36.891</span>
<span class="co">#&gt;  [91] 36.985 37.104 37.162 37.274 37.470 37.664 37.683 37.954 37.972 38.119</span>
<span class="co">#&gt; [101] 38.584 38.713 38.791 38.841 38.986 39.246 39.246 39.724 39.784 40.052</span>
<span class="co">#&gt; [111] 40.180 41.150 41.327 41.638 41.976 42.121 42.134 42.168 42.489 42.561</span>
<span class="co">#&gt; [121] 42.646 42.984 43.148 43.354 43.360 43.485 43.601 43.624 43.681 43.832</span>
<span class="co">#&gt; [131] 43.929 44.216 44.243 44.464 44.554 44.577 44.605 44.658 44.725 45.069</span>
<span class="co">#&gt; [141] 45.428 45.530 45.604 46.162 46.175 46.344 46.360 46.373 46.412 46.618</span>
<span class="co">#&gt; [151] 46.635 46.751 47.016 47.241 47.389 47.410 47.608 47.615 48.209 48.276</span>
<span class="co">#&gt; [161] 48.309 48.522 48.632 49.119 49.131 49.179 49.441 49.588 50.143 50.641</span>
<span class="co">#&gt; [171] 51.114 51.145 51.248 51.302 51.861 52.036 52.178 52.444 52.576 52.810</span>
<span class="co">#&gt; [181] 53.078 53.593 53.620 53.793 54.327 54.468 54.520 54.736 55.392 55.455</span>
<span class="co">#&gt; [191] 55.504 55.592 55.909 56.004 56.030 56.384 57.047 57.223 57.362 58.657</span>
<span class="co">#&gt; [201] 62.143 62.740 62.805 62.848 63.155 64.557 65.448 66.102 66.286 67.761</span>
<span class="co">#&gt; [211] 68.581 70.084 76.722 98.653</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $lambda.max</span>
<span class="co">#&gt; [1] 7.122494</span></pre></div>
<ul>
<li>Markov-Modulated Hawkes Process:</li>
</ul>
<p>simulatemmhp(mmhp, n = 1, given_state = FALSE, states = NULL, seed = NULL, …) returns a list containing x, z, events, zt, lambda.max if given_state is FALSE; or a list containing events, zt, lambda.max if given_state is TRUE.</p>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulatemmhp.html">simulatemmhp</a></span><span class="op">(</span><span class="va">mmhp_obj</span>,n <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>
<span class="va">y</span>
<span class="co">#&gt; $x</span>
<span class="co">#&gt;  [1]  0.000  0.771  4.985  9.193 10.747 22.456 22.594 31.700 34.113 35.874</span>
<span class="co">#&gt; [11] 36.931 38.415 39.895 50.184 52.708 53.506 68.872 73.217 75.072 84.282</span>
<span class="co">#&gt; [21] 84.301 85.691 93.380 93.589 99.473</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $z</span>
<span class="co">#&gt;  [1] 2 1 2 1 2 1 2 1 2 1 2 1 2 1 2 1 2 1 2 1 2 1 2 1 2</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $events</span>
<span class="co">#&gt;  [1]  0.000  1.337  4.588  5.346  8.065  8.823  9.300  9.876 10.416 10.669</span>
<span class="co">#&gt; [11] 17.554 31.748 31.867 32.530 32.996 39.145 51.410 54.612 55.517 57.760</span>
<span class="co">#&gt; [21] 60.678 60.766 62.334 63.241 65.494 65.634 66.089 67.010 67.775 72.277</span>
<span class="co">#&gt; [31] 74.259 74.314 74.800 74.917 79.730 85.604 85.868 86.144 86.164 86.440</span>
<span class="co">#&gt; [41] 88.908 90.312 90.890 92.064 94.242 94.249 95.082 95.545 95.768 96.795</span>
<span class="co">#&gt; [51] 97.018</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $zt</span>
<span class="co">#&gt;  [1] 2 1 1 2 2 2 1 1 1 1 2 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 1 1 1 1 2 2 1 1</span>
<span class="co">#&gt; [39] 1 1 1 1 1 1 1 1 1 1 1 1 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $lambda.max</span>
<span class="co">#&gt; [1] 1.526639</span></pre></div>
</div>
<div id="fitting-a-point-process" class="section level2">
<h2 class="hasAnchor">
<a href="#fitting-a-point-process" class="anchor"></a>Fitting a point process</h2>
<p>Functions for fitting objects include fithpp and fithp, which take in event times and produce object of type hpp and hp, respectively.</p>
<ul>
<li>Homogeneous Poisson Process:</li>
</ul>
<p>fithpp(events) returns an object of class ‘hpp’.</p>
<div class="sourceCode" id="cb9"><pre class="downlit">
<span class="va">fit_hpp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fithpp.html">fithpp</a></span><span class="op">(</span><span class="va">events</span><span class="op">)</span>
<span class="va">fit_hpp</span>
<span class="co">#&gt; $lambda</span>
<span class="co">#&gt; [1] 0.9719222</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $start</span>
<span class="co">#&gt; [1] 0.02</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $end</span>
<span class="co">#&gt; [1] 9.28</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $n</span>
<span class="co">#&gt; [1] 9</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $events</span>
<span class="co">#&gt; [1] 0.02 0.22 2.78 5.19 5.68 6.22 6.80 8.60 9.28</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"class")</span>
<span class="co">#&gt; [1] "hpp"</span></pre></div>
<ul>
<li>Hawkes Process:</li>
</ul>
<p>fithp(vec,t,end) returns an object of class ‘hp’.</p>
<div class="sourceCode" id="cb10"><pre class="downlit">
<span class="va">init</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">3</span><span class="op">)</span>
<span class="va">fit_hp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fithp.html">fithp</a></span><span class="op">(</span><span class="va">init</span>,<span class="va">sims</span><span class="op">$</span><span class="va">t</span>,<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">sims</span><span class="op">$</span><span class="va">t</span><span class="op">)</span><span class="op">)</span>
<span class="va">fit_hp</span>
<span class="co">#&gt; $lambda0</span>
<span class="co">#&gt; [1] 0.1277708</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $alpha</span>
<span class="co">#&gt; [1] 0.4494989</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $beta</span>
<span class="co">#&gt; [1] 0.4753996</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $t</span>
<span class="co">#&gt;   [1]  0.735  8.701 11.649 12.271 12.291 12.553 12.816 13.052 13.265 13.277</span>
<span class="co">#&gt;  [11] 13.598 14.839 15.554 15.961 16.123 16.509 16.561 16.591 16.966 17.246</span>
<span class="co">#&gt;  [21] 18.038 19.570 19.629 20.185 20.194 20.323 20.329 20.759 20.836 21.096</span>
<span class="co">#&gt;  [31] 21.713 21.987 23.249 23.570 23.813 24.248 24.533 24.648 24.747 24.875</span>
<span class="co">#&gt;  [41] 24.985 25.006 25.458 25.861 26.275 26.408 26.508 26.686 26.881 27.345</span>
<span class="co">#&gt;  [51] 27.642 27.679 28.047 30.136 30.245 30.633 30.657 30.783 30.867 30.988</span>
<span class="co">#&gt;  [61] 31.764 32.039 32.148 32.310 32.328 32.768 33.253 33.349 33.710 33.729</span>
<span class="co">#&gt;  [71] 33.860 34.065 34.121 34.279 34.546 34.618 35.115 35.139 35.293 35.494</span>
<span class="co">#&gt;  [81] 35.520 35.643 35.772 36.038 36.051 36.249 36.539 36.649 36.824 36.891</span>
<span class="co">#&gt;  [91] 36.985 37.104 37.162 37.274 37.470 37.664 37.683 37.954 37.972 38.119</span>
<span class="co">#&gt; [101] 38.584 38.713 38.791 38.841 38.986 39.246 39.246 39.724 39.784 40.052</span>
<span class="co">#&gt; [111] 40.180 41.150 41.327 41.638 41.976 42.121 42.134 42.168 42.489 42.561</span>
<span class="co">#&gt; [121] 42.646 42.984 43.148 43.354 43.360 43.485 43.601 43.624 43.681 43.832</span>
<span class="co">#&gt; [131] 43.929 44.216 44.243 44.464 44.554 44.577 44.605 44.658 44.725 45.069</span>
<span class="co">#&gt; [141] 45.428 45.530 45.604 46.162 46.175 46.344 46.360 46.373 46.412 46.618</span>
<span class="co">#&gt; [151] 46.635 46.751 47.016 47.241 47.389 47.410 47.608 47.615 48.209 48.276</span>
<span class="co">#&gt; [161] 48.309 48.522 48.632 49.119 49.131 49.179 49.441 49.588 50.143 50.641</span>
<span class="co">#&gt; [171] 51.114 51.145 51.248 51.302 51.861 52.036 52.178 52.444 52.576 52.810</span>
<span class="co">#&gt; [181] 53.078 53.593 53.620 53.793 54.327 54.468 54.520 54.736 55.392 55.455</span>
<span class="co">#&gt; [191] 55.504 55.592 55.909 56.004 56.030 56.384 57.047 57.223 57.362 58.657</span>
<span class="co">#&gt; [201] 62.143 62.740 62.805 62.848 63.155 64.557 65.448 66.102 66.286 67.761</span>
<span class="co">#&gt; [211] 68.581 70.084 76.722 98.653</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"class")</span>
<span class="co">#&gt; [1] "hp"</span></pre></div>
</div>
<div id="diagnosing-the-fit-of-a-point-process-to-data" class="section level2">
<h2 class="hasAnchor">
<a href="#diagnosing-the-fit-of-a-point-process-to-data" class="anchor"></a>Diagnosing the fit of a point process to data</h2>
<p>There are several existing methods which can be used to assess the goodness of fit of a point process to temporal data. In this package we allow a user to:</p>
<ul>
<li>Examine the distribution of the rescaled interevent times, by utilising the time rescaling theorem.</li>
<li>Examine the residual process of an estimated point process, in particular computing the raw and Pearson residuals for a given point process fit to data.</li>
<li>Visually inspect the estimated intensity of the point process.</li>
</ul>
<p>drawHPPIntensity(hpp, events = NULL, color = “red”, plot_events = FALSE, fit = FALSE, int_title = “Intensity homogeneous Poisson Process”) plots the intensity of a homogeneous poisson process.</p>
<p>To plot the simulated events with the intensity, specify plot_events=FALSE.</p>
<div class="sourceCode" id="cb11"><pre class="downlit">
<span class="fu"><a href="../reference/drawHPPIntensity.html">drawHPPIntensity</a></span><span class="op">(</span><span class="va">fit_hpp</span>,events<span class="op">=</span><span class="va">events</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span>
<span class="co">#&gt; The inputted events not used, hpp object</span>
<span class="co">#&gt;                and simulated events will be plotted.</span>
<span class="co">#&gt; 9 events simulated, end time ignored. To simulate up to an endtime don't specify n.</span></pre></div>
<p><img src="my-vignette_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<p>To plot the inputted events with the intensity, specify plot_events=TRUE.</p>
<div class="sourceCode" id="cb12"><pre class="downlit">
<span class="fu"><a href="../reference/drawHPPIntensity.html">drawHPPIntensity</a></span><span class="op">(</span><span class="va">fit_hpp</span>, events<span class="op">=</span><span class="va">events</span>, color <span class="op">=</span> <span class="st">"red"</span>, plot_events<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; Fitting specified hpp.</span></pre></div>
<p><img src="my-vignette_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<p>drawHPIntensity(hp_obj, start, end, history=0, events, color = 1, i = 1, add=FALSE, fit=FALSE, plot_events=FALSE, vec=NULL, int_title=“Hawkes Intensity”) plots the intensity of a hawkes process.</p>
<div class="sourceCode" id="cb13"><pre class="downlit">
<span class="fu"><a href="../reference/drawHPIntensity.html">drawHPIntensity</a></span><span class="op">(</span><span class="va">fit_hp</span>, start<span class="op">=</span><span class="fl">0</span>, end<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">sims</span><span class="op">$</span><span class="va">t</span><span class="op">)</span>, history<span class="op">=</span><span class="fl">0</span>, events <span class="op">=</span> <span class="va">sims</span><span class="op">$</span><span class="va">t</span>, plot_events <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; Using specified hp object.</span></pre></div>
<p><img src="my-vignette_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<p>drawUniMMHPIntensity(mmhp, simulation, add = FALSE, color = 1, given_main = “Intensity Plot of MMHP”) plots the intensity of a mmhp process.</p>
<div class="sourceCode" id="cb14"><pre class="downlit">
<span class="fu"><a href="../reference/drawUniMMHPIntensity.html">drawUniMMHPIntensity</a></span><span class="op">(</span><span class="va">mmhp_obj</span>, <span class="va">y</span><span class="op">)</span></pre></div>
<p><img src="my-vignette_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<p>diagpp(object, events, pzt = NULL) gives diagnostics of the model, including a qq plot, a ks plot, ks test, raw and pearson residuals. For hpp:</p>
<div class="sourceCode" id="cb15"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/try.html">try</a></span><span class="op">(</span><span class="fu"><a href="../reference/diagpp.html">diagpp</a></span><span class="op">(</span><span class="va">hpp_obj</span>,<span class="va">events</span><span class="op">)</span><span class="op">)</span></pre></div>
<p><img src="my-vignette_files/figure-html/unnamed-chunk-15-1.png" width="700"><img src="my-vignette_files/figure-html/unnamed-chunk-15-2.png" width="700"></p>
<pre><code>#&gt; 
#&gt; Raw residual: -1
#&gt; Pearson residual: -0.28
#&gt; 
#&gt;  One-sample Kolmogorov-Smirnov test
#&gt; 
#&gt; data:  r
#&gt; D = 0.17328, p-value = 0.9095
#&gt; alternative hypothesis: two-sided</code></pre>
<p>For hp:</p>
<div class="sourceCode" id="cb17"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/try.html">try</a></span><span class="op">(</span><span class="fu"><a href="../reference/diagpp.html">diagpp</a></span><span class="op">(</span><span class="va">hp_obj</span>, <span class="va">sims</span><span class="op">$</span><span class="va">t</span><span class="op">)</span><span class="op">)</span></pre></div>
<p><img src="my-vignette_files/figure-html/unnamed-chunk-16-1.png" width="700"><img src="my-vignette_files/figure-html/unnamed-chunk-16-2.png" width="700"></p>
<pre><code>#&gt; Raw residual: 12.43472
#&gt; Pearson residual: 10.18691
#&gt; 
#&gt;  One-sample Kolmogorov-Smirnov test
#&gt; 
#&gt; data:  r
#&gt; D = 0.038105, p-value = 0.9152
#&gt; alternative hypothesis: two-sided</code></pre>
<p>For mmhp:</p>
<div class="sourceCode" id="cb19"><pre class="downlit">
<span class="fu"><a href="../reference/diagpp.html">diagpp</a></span><span class="op">(</span><span class="va">mmhp_obj</span>, events <span class="op">=</span> <span class="va">y</span><span class="op">$</span><span class="va">events</span>, pzt <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></pre></div>
<p><img src="my-vignette_files/figure-html/unnamed-chunk-17-1.png" width="700"><img src="my-vignette_files/figure-html/unnamed-chunk-17-2.png" width="700"></p>
<pre><code>#&gt; 
#&gt;  One-sample Kolmogorov-Smirnov test
#&gt; 
#&gt; data:  r
#&gt; D = 0.14254, p-value = 0.238
#&gt; alternative hypothesis: two-sided</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Owen G. Ward.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
