---
title: "`ppdiag`, diagnostic tools for Point Processes"
output: rmarkdown::html_vignette
author: Sally Sun, Owen G. Ward et al.
vignette: >
  %\VignetteIndexEntry{my-vignette}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(ppdiag)
```

This vignette provides an introduction to the functions 
available in `ppdiag` to evaluate the fit of univariate temporal 
point processes.

To achieve this, we currently include a range of functions which allow
a user to:

- Simulate data from a range of common univariate point processes.
- Fit a range of univariate point processes to data.
- After fitting a point process to some data, evaluate the ability of that 
point process to capture the temporal structure present in this data.

## Classes
- Homogeneous Poisson Process: 

hpp(lambda, start=0, end=1, n = NULL) creates an object of a list type in class 'hpp'. 
```{r}
hpp_obj <- hpp(lambda = 1, end = 10)
hpp_obj
```

- Hawkes Process: 

hp(lambda0, alpha, beta, events = NULL) creates an object of list type in class 'hp'.
```{r}
hp_obj <- hp(lambda0 = 0.1,alpha = 0.45,beta = 0.5)
hp_obj
```

- Markov-Modulated Hawkes Process: 

mmhp(lambda0, lambda1, alpha, beta, Q = NULL, delta = NULL, events = NULL) creates an object of type in class 'mmhp'. 
```{r}
Q <- matrix(c(-0.4, 0.4, 0.2, -0.2), ncol = 2, byrow = TRUE)

mmhp_obj <- mmhp(Q, delta = c(1 / 3, 2 / 3), 
          lambda0 = 0.2,
          lambda1 = .75,
          alpha = 0.1,
          beta = 0.2)
```

## Simulating data
Functions for simulating data include simulatehpp, simulatehp, and simulatemmhp, which take in objects of type hpp, hp, and mmhp, respectively, with additional parameters for simulation, and produces vector of simulated event times. 

- Homogeneous Poisson Process: 

simulatehpp(hpp) takes a hpp object and returns a vector of event times. In the hpp object, one can either specify n, which is expected number of events, or end, which is the expected end time of event times. If both are provided, then the function will automatically simulate n events regardless of the end time specified. 

Simulating by end time: 
```{r}
simulatehpp(hpp_obj)
```
Simulating by n: 
```{r}
hpp_obj$n <- 50
simulatehpp(hpp_obj)
```

- Hawkes Process: 

simulatehp(hp, start=0, end, history=0) returns a list containing t and lambda.max.
```{r}
simulatehp(hp_obj,start = 0, end = 100)
```

- Markov-Modulated Hawkes Process: 

simulatemmhp(mmhp, n = 1, given_state = FALSE, states = NULL, seed = NULL, ...) returns a list containing x, z, events, zt, lambda.max if given_state is FALSE; or a list containing events, zt, lambda.max if given_state is TRUE. 
```{r}
simulatemmhp(mmhp_obj,n = 50)
```



## Fitting a point process


## Diagnosing the fit of a point process to data

There are several existing methods which can be used to assess the 
goodness of fit of a point process to temporal data. In this package 
we allow a user to:

- Examine the distribution of the rescaled interevent times, by utilising the
time rescaling theorem.
- Examine the residual process of an estimated point process, 
in particular computing the raw and Pearson residuals for a given point process fit to data.
- Visually inspect the estimated intensity of the point process.