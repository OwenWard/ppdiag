<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Summary • ppdiag</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script>




<meta property="og:title" content="Summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-title-body">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">ppdiag</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="articles/ppdiag.html">Get started</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="articles/fitting_markov_modulated.html">Fitting Markov Modulated Point Process Models</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="contents col-md-9">
    <div class="page-header">
      <h1>Summary</h1>
    </div>


<hr>
<p>title: ‘ppdiag: Diagnostic Tools for Temporal Point Processes’ tags:</p>
<ul>
<li>R</li>
<li>Diagnostics</li>
<li>Temporal Point Processes authors:</li>
<li>name: Sally Sun
#affiliation: 1 # (Multiple affiliations must be quoted)</li>
<li>name: Owen G. Ward
#orcid: 0000-0002-9678-3542
#affiliation: 1</li>
<li>name: Xiaoxi Zhao</li>
<li>name: Jing Wu</li>
<li>name: Tian Zheng affiliations:</li>
<li>name: Columbia University citation_author: Sun et. al. date: “2021-02-12” year: 2020 bibliography: paper.bib output: rticles::joss_article csl: apa.csl journal: JOSS —</li>
</ul>
<div id="summary" class="section level1">

<p>Temporal Point Processes are widely used to model phenomena in many fields, such as finance and neuroscience. However, tools to evaluate the fit of these point processes to data, and to identify reasons for lack of fit, are not readily implemented in common software. Here we provide <code>ppdiag</code>, an <code>R</code> package containing a selection of statistically motivated tools to analyse the goodness of fit of point processes to data, as have been utilised in @wu2020diagnostics.</p>
</div>
<div id="statement-of-need" class="section level1">
<h1 class="hasAnchor">
<a href="#statement-of-need" class="anchor"></a>Statement of Need</h1>
<p>This package provides functions to evaluate the fit of univariate temporal point processes. These functions allow:</p>
<ul>
<li><p>Simulation of data from a range of common univariate point processes including Homogeneous Poisson Process, Hawkes Process, and Markov-modulated Hawkes Process.</p></li>
<li><p>Fitting common univariate point processes to data, and plotting the intensity function over data.</p></li>
<li><p>After fitting a point process model to data, evaluating the ability of that model to capture the temporal structure present in data. Methods for diagnostics include raw and Pearson residuals, a Kolmogrov-Smirnov test and corresponding diagnostic plots.</p></li>
</ul>
</div>
<div id="demonstration" class="section level1">
<h1 class="hasAnchor">
<a href="#demonstration" class="anchor"></a>Demonstration</h1>
<p>We illustrate the use of this functionality with a simple example of readily available email data [@openintro_20].</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">ppdiag</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">openintro</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">lubridate</span><span class="op">)</span>
<span class="va">first</span> <span class="op">&lt;-</span> <span class="fu">ymd_hms</span><span class="op">(</span><span class="va">email</span><span class="op">$</span><span class="va">time</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,tz<span class="op">=</span><span class="st">"EST"</span><span class="op">)</span>
<span class="va">second</span> <span class="op">&lt;-</span> <span class="fu">ymd_hms</span><span class="op">(</span><span class="va">email</span><span class="op">$</span><span class="va">time</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,tz<span class="op">=</span><span class="st">"EST"</span><span class="op">)</span>
<span class="va">time</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu">as.duration</span><span class="op">(</span><span class="fu">interval</span><span class="op">(</span><span class="va">first</span>,
                    <span class="fu">ymd_hms</span><span class="op">(</span><span class="va">email</span><span class="op">$</span><span class="va">time</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,tz<span class="op">=</span><span class="st">"EST"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">3600</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">300</span><span class="op">]</span>
<span class="va">time_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>We can fit a homogeneous Poisson process and look at the goodness of fit of this model to the data.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">email_hpp</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/fithpp.html">fithpp</a></span><span class="op">(</span><span class="va">time_data</span><span class="op">)</span>
<span class="fu"><a href="reference/pp_diag.html">pp_diag</a></span><span class="op">(</span><span class="va">email_hpp</span>, events <span class="op">=</span> <span class="va">time_data</span><span class="op">)</span>
<span class="co">#&gt; Please input the right model. Select from hp, hpp, mmpp and mmhp.</span></code></pre></div>
<p>Similarly, we can fit a self exciting Hawkes process to this data and examine the results of that fit.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">email_hp</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/fithp.html">fithp</a></span><span class="op">(</span>events <span class="op">=</span> <span class="va">time_data</span><span class="op">)</span>
<span class="fu"><a href="reference/pp_diag.html">pp_diag</a></span><span class="op">(</span><span class="va">email_hp</span>, <span class="va">time_data</span><span class="op">)</span>
<span class="co">#&gt; Please input the right model. Select from hp, hpp, mmpp and mmhp.</span></code></pre></div>
<p>Examining the results of the Kolmogrov-Smirnov test, based on the time rescaling theorem [@brown2002time], indicates that a Hawkes process better describes these events.</p>
<p>We can then examine the estimated intensity of this Hawkes process to this data.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/drawHPIntensity.html">drawHPIntensity</a></span><span class="op">(</span><span class="va">email_hp</span>, events <span class="op">=</span> <span class="va">time_data</span>, 
                plot_events <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><embed src="paper_files/figure-latex/hawkes%20intensity-1.pdf"></embed><!-- --></p>
</div>
<div id="comparison-with-other-packages" class="section level1">
<h1 class="hasAnchor">
<a href="#comparison-with-other-packages" class="anchor"></a>Comparison with Other Packages</h1>
<p>Though there are some packages that contain functions for simulating point processes, [@hawkes_14],[@Markov_17], to the best of our knowledge, there are no existing packages that provide methods for diagnostics of different temporal point processes and for comparing the fit of these point processes.</p>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
</div>


  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>

</div>



      <footer>
      <div class="copyright">
  <p>Developed by Sally Sun, Owen G. Ward, Jing Wu, Xiaoxi Zhao, Tian Zheng.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


